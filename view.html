<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Statistics</title>
    <!-- Bootstrap CSS -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .highlight {
            background-color: lightgreen; /* Highlights the most repeated value or highest values */
        }
        .highlight-lowest {
            background-color: lightgreen; /* Highlights the lowest values for ERA stats */
        }
        .custom-container {
            margin: 10px;
            max-width: 98%;
        }
        .table-container {
            border: 3px solid black; /* Bold border for each table container */
            padding: 10px;
            margin-bottom: 20px; /* Adds bottom margin for spacing between each game's tables */
        }

        thead {
            th,
            td {
                font-size: 9px;
            }
        }
    </style>
</head>
<body>
    <div class="container custom-container">
        <h1>Game Statistics</h1>
        <!-- Dynamic game tables will be added here -->
    </div>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script>
        const data = [
    {
        "common": {
            "game": "CHI Cubs @ SF Giants",
            "formulaWinner": "CHICubs",
            "seriesWinner": "SFGiants",
            "nextWinners": "CHICubs",
            "overallWinner": "CHICubs",
            "overallDiff": 32.25494420174247,
            "stdDev": 0.9609495304124978,
            "isF5HomeWinner": "CHICubs",
            "isF5HomeWinnerProb": 0.5814633412374343,
            "isHomeWinner": "CHICubs",
            "isHomeWinnerProb": 0.6680937631464746,
            "isOver": "No consistent",
            "isOverProb": 0,
            "date": "June27th"
        },
        "compare": {
            "awayRow": {
                "team": "CHICubs",
                "RelevingRuns": 1.7160493827160495,
                "formulaWinPercentage": 82.43003535023277,
                "SeriesPercentage": 30.95238095238095,
                "NextWinningPercentage": 85,
                "CurrentStreak": "L4-0",
                "TotalPercentage": 66.12747210087123,
                "Pitcher": "S Imanaga",
                "CarrerEra": 2.96,
                "CurrentEra": 2.96,
                "SpecificEra": 1.09,
                "PitcherWins": 4,
                "PitcherLoses": 2,
                "FinalEra": 2.96,
                "AVG": 0.23596576160465052,
                "OPS": 0.5099661312624276,
                "OBP": 0.242,
                "SLG": 0,
                "CoversPer": 42
            },
            "homeRow": {
                "team": "SFGiants",
                "RelevingRuns": 2.049382716049383,
                "formulaWinPercentage": 17.56996464976723,
                "SeriesPercentage": 69.04761904761905,
                "NextWinningPercentage": 15,
                "CurrentStreak": "W3-0",
                "TotalPercentage": 33.87252789912876,
                "Pitcher": "J Hicks",
                "CarrerEra": 3.69,
                "CurrentEra": 3.24,
                "SpecificEra": 1.9349999999999998,
                "PitcherWins": 3,
                "PitcherLoses": 5,
                "FinalEra": 3.465,
                "AVG": 0.24899399002917522,
                "OPS": 0.5230877832729685,
                "OBP": 0.2515555555555556,
                "SLG": 0.6666666666666666,
                "CoversPer": 58
            },
            "selected": {
                "team": "CHICubs"
            }
        }
    },
    {
        "common": {
            "game": "ATL Braves @ CHI White",
            "formulaWinner": "ATLBraves",
            "seriesWinner": "ATLBraves",
            "nextWinners": "CHIWhite",
            "overallWinner": "ATLBraves",
            "overallDiff": 38.22339957489757,
            "stdDev": 1.5229078904866749,
            "isF5HomeWinner": "ATLBraves",
            "isF5HomeWinnerProb": 0.8001610104311911,
            "isHomeWinner": "ATLBraves",
            "isHomeWinnerProb": 0.6747040778243913,
            "isOver": "No consistent",
            "isOverProb": 0,
            "date": "June27th"
        },
        "compare": {
            "awayRow": {
                "team": "ATLBraves",
                "RelevingRuns": 1.1923076923076923,
                "formulaWinPercentage": 80.05763286729689,
                "SeriesPercentage": 73.97599690282618,
                "NextWinningPercentage": 38.313696895969656,
                "CurrentStreak": "L1-0",
                "TotalPercentage": 69.11169978744879,
                "Pitcher": "C Sale",
                "CarrerEra": 3.09,
                "CurrentEra": 2.91,
                "SpecificEra": 3.24,
                "PitcherWins": 3,
                "PitcherLoses": 3,
                "FinalEra": 3,
                "AVG": 0.25854150571650575,
                "OPS": 0.5068110308494924,
                "OBP": 0.2484285714285714,
                "SLG": 0,
                "CoversPer": 72
            },
            "homeRow": {
                "team": "CHIWhite",
                "RelevingRuns": 1.9878048780487805,
                "formulaWinPercentage": 19.94236713270312,
                "SeriesPercentage": 26.024003097173818,
                "NextWinningPercentage": 40,
                "CurrentStreak": "L4-0",
                "TotalPercentage": 30.88830021255121,
                "Pitcher": "D Thorpe",
                "CarrerEra": 5.02,
                "CurrentEra": 5.02,
                "SpecificEra": 0,
                "PitcherWins": 0,
                "PitcherLoses": 0,
                "FinalEra": 5.02,
                "AVG": 0.2154887777872534,
                "OPS": 0.3846645224694006,
                "OBP": 0.22910000000000003,
                "SLG": 0,
                "CoversPer": 28
            },
            "selected": {
                "team": "ATLBraves"
            }
        }
    },
    {
        "common": {
            "game": "MIA Marlins @ PHI Phillies",
            "formulaWinner": "PHIPhillies",
            "seriesWinner": "PHIPhillies",
            "nextWinners": "PHIPhillies",
            "overallWinner": "PHIPhillies",
            "overallDiff": 57.004358440852485,
            "stdDev": 1.8248957656687015,
            "isF5HomeWinner": "PHIPhillies",
            "isF5HomeWinnerProb": 0.7973293955470926,
            "isHomeWinner": "PHIPhillies",
            "isHomeWinnerProb": 0.8061639534365564,
            "isOver": "Under",
            "isOverProb": 0.6316985050442001,
            "date": "June27th"
        },
        "compare": {
            "awayRow": {
                "team": "MIAMarlins",
                "RelevingRuns": 1.9625,
                "formulaWinPercentage": 5.654176624435557,
                "SeriesPercentage": 18.839285714285722,
                "NextWinningPercentage": 40,
                "CurrentStreak": "L1-0",
                "TotalPercentage": 21.49782077957376,
                "Pitcher": "T Rogers",
                "CarrerEra": 4.28,
                "CurrentEra": 4.9,
                "SpecificEra": 5.2059999999999995,
                "PitcherWins": 1,
                "PitcherLoses": 4,
                "FinalEra": 4.59,
                "AVG": 0.22231901955683214,
                "OPS": 0.4263191149128648,
                "OBP": 0.2386,
                "SLG": 0,
                "CoversPer": 22
            },
            "homeRow": {
                "team": "PHIPhillies",
                "RelevingRuns": 1.2375,
                "formulaWinPercentage": 94.34582337556445,
                "SeriesPercentage": 81.16071428571428,
                "NextWinningPercentage": 60,
                "CurrentStreak": "W1-0",
                "TotalPercentage": 78.50217922042624,
                "Pitcher": "Z Wheeler",
                "CarrerEra": 3.4,
                "CurrentEra": 2.73,
                "SpecificEra": 1.9666666666666666,
                "PitcherWins": 6,
                "PitcherLoses": 3,
                "FinalEra": 3.065,
                "AVG": 0.24620772182678435,
                "OPS": 0.5499755452880455,
                "OBP": 0.2637777777777778,
                "SLG": 0.5,
                "CoversPer": 78
            },
            "selected": {
                "team": "PHIPhillies"
            }
        }
    },
    {
        "common": {
            "game": "TEX Rangers @ BAL Orioles",
            "formulaWinner": "BALOrioles",
            "seriesWinner": "BALOrioles",
            "nextWinners": "BALOrioles",
            "overallWinner": "BALOrioles",
            "overallDiff": 62.985560501064434,
            "stdDev": 1.8848433747520013,
            "isF5HomeWinner": "BALOrioles",
            "isF5HomeWinnerProb": 0.660304065209433,
            "isHomeWinner": "BALOrioles",
            "isHomeWinnerProb": 0.7235853922325484,
            "isOver": "No consistent",
            "isOverProb": 0,
            "date": "June27th"
        },
        "compare": {
            "awayRow": {
                "team": "TEXRangers",
                "RelevingRuns": 1.9,
                "formulaWinPercentage": 7.473720402010278,
                "SeriesPercentage": 28.9375,
                "NextWinningPercentage": 12.949062013950254,
                "CurrentStreak": "L3-0",
                "TotalPercentage": 18.507219749467787,
                "Pitcher": "J Gray",
                "CarrerEra": 4.37,
                "CurrentEra": 3.03,
                "SpecificEra": 2.638333333333333,
                "PitcherWins": 2,
                "PitcherLoses": 4,
                "FinalEra": 3.03,
                "AVG": 0.25068890224358986,
                "OPS": 0.4923838641471187,
                "OBP": 0.2311,
                "SLG": 0.5,
                "CoversPer": 46
            },
            "homeRow": {
                "team": "BALOrioles",
                "RelevingRuns": 1.2625,
                "formulaWinPercentage": 92.52627959798971,
                "SeriesPercentage": 71.0625,
                "NextWinningPercentage": 53.75919067959653,
                "CurrentStreak": "W1-0",
                "TotalPercentage": 81.49278025053222,
                "Pitcher": "C Burnes",
                "CarrerEra": 3.15,
                "CurrentEra": 2.35,
                "SpecificEra": 2.3311111111111114,
                "PitcherWins": 6,
                "PitcherLoses": 3,
                "FinalEra": 2.75,
                "AVG": 0.2599759829223065,
                "OPS": 0.5741282803453857,
                "OBP": 0.25199999999999995,
                "SLG": 0.4444444444444444,
                "CoversPer": 54
            },
            "selected": {}
        }
    },
    {
        "common": {
            "game": "NY Yankees @ TOR Blue",
            "formulaWinner": "TORBlue",
            "seriesWinner": "TORBlue",
            "nextWinners": "NYYankees",
            "overallWinner": "TORBlue",
            "overallDiff": 18.256181085334056,
            "stdDev": 0.7614049513892066,
            "isF5HomeWinner": "NYYankees",
            "isF5HomeWinnerProb": 0.7735160212559424,
            "isHomeWinner": "NYYankees",
            "isHomeWinnerProb": 0.742478576064013,
            "isOver": "No consistent",
            "isOverProb": 0,
            "date": "June27th"
        },
        "compare": {
            "awayRow": {
                "team": "NYYankees",
                "RelevingRuns": 1.3414634146341464,
                "formulaWinPercentage": 26.03308913723357,
                "SeriesPercentage": 32.38095238095238,
                "NextWinningPercentage": 85,
                "CurrentStreak": "L3-0",
                "TotalPercentage": 40.871909457332976,
                "Pitcher": "C Rodon",
                "CarrerEra": 3.83,
                "CurrentEra": 3.86,
                "SpecificEra": 3.025,
                "PitcherWins": 7,
                "PitcherLoses": 3,
                "FinalEra": 3.8449999999999998,
                "AVG": 0.24482601375589189,
                "OPS": 0.5807020803330173,
                "OBP": 0.2503333333333333,
                "SLG": 1,
                "CoversPer": 73
            },
            "homeRow": {
                "team": "TORBlue",
                "RelevingRuns": 1.9240506329113924,
                "formulaWinPercentage": 73.96691086276644,
                "SeriesPercentage": 67.61904761904762,
                "NextWinningPercentage": 65.88657080702052,
                "CurrentStreak": "W1-0",
                "TotalPercentage": 59.12809054266703,
                "Pitcher": "J Berrios",
                "CarrerEra": 4.09,
                "CurrentEra": 3.43,
                "SpecificEra": 2.2328571428571427,
                "PitcherWins": 6,
                "PitcherLoses": 1,
                "FinalEra": 3.76,
                "AVG": 0.23001974569031536,
                "OPS": 0.462895192009116,
                "OBP": 0.24445454545454545,
                "SLG": 0.8181818181818182,
                "CoversPer": 27
            },
            "selected": {}
        }
    },
    {
        "common": {
            "game": "CIN Reds @ STL Cardinals",
            "formulaWinner": "CINReds",
            "seriesWinner": "STLCardinals",
            "nextWinners": "STLCardinals",
            "overallWinner": "CINReds",
            "overallDiff": 5.159808423552967,
            "stdDev": 1.6705445970642139,
            "isF5HomeWinner": "CINReds",
            "isF5HomeWinnerProb": 0.6670745042523657,
            "isHomeWinner": "No consistent",
            "isHomeWinnerProb": 0,
            "isOver": "Over",
            "isOverProb": 0.581598710117347,
            "date": "June27th"
        },
        "compare": {
            "awayRow": {
                "team": "CINReds",
                "RelevingRuns": 1.725,
                "formulaWinPercentage": 92.26320002612356,
                "SeriesPercentage": 22.38095238095238,
                "NextWinningPercentage": 36.48381492122505,
                "CurrentStreak": "L2-0",
                "TotalPercentage": 52.57990421177648,
                "Pitcher": "A Abbott",
                "CarrerEra": 3.66,
                "CurrentEra": 3.4,
                "SpecificEra": 3.14625,
                "PitcherWins": 4,
                "PitcherLoses": 4,
                "FinalEra": 3.5300000000000002,
                "AVG": 0.2278084602203351,
                "OPS": 0.5206023837273837,
                "OBP": 0.19622222222222221,
                "SLG": 0.25,
                "CoversPer": 72
            },
            "homeRow": {
                "team": "STLCardinals",
                "RelevingRuns": 1.8227848101265822,
                "formulaWinPercentage": 7.736799973876433,
                "SeriesPercentage": 77.61904761904762,
                "NextWinningPercentage": 50.941522940939414,
                "CurrentStreak": "W1-0",
                "TotalPercentage": 47.42009578822351,
                "Pitcher": "M Mikolas",
                "CarrerEra": 4,
                "CurrentEra": 4.68,
                "SpecificEra": 5.517142857142857,
                "PitcherWins": 3,
                "PitcherLoses": 4,
                "FinalEra": 4.34,
                "AVG": 0.21947731733807677,
                "OPS": 0.4914383085269162,
                "OBP": 0.2353,
                "SLG": 0.5,
                "CoversPer": 28
            },
            "selected": {
                "team": "CINReds"
            }
        }
    },
    {
        "common": {
            "game": "CLE Guardians @ KC Royals",
            "formulaWinner": "CLEGuardians",
            "seriesWinner": "CLEGuardians",
            "nextWinners": "KCRoyals",
            "overallWinner": "CLEGuardians",
            "overallDiff": 14.901139276049257,
            "stdDev": 0.9992437140157551,
            "isF5HomeWinner": "CLEGuardians",
            "isF5HomeWinnerProb": 0.696437683523681,
            "isHomeWinner": "CLEGuardians",
            "isHomeWinnerProb": 0.5649263563827797,
            "isOver": "Over",
            "isOverProb": 0.7051844484911944,
            "date": "June27th"
        },
        "compare": {
            "awayRow": {
                "team": "CLEGuardians",
                "RelevingRuns": 1.1025641025641026,
                "formulaWinPercentage": 68.83484032382091,
                "SeriesPercentage": 73.82783882783883,
                "NextWinningPercentage": 15.767078078675453,
                "CurrentStreak": "L1-0",
                "TotalPercentage": 57.45056963802463,
                "Pitcher": "B Lively",
                "CarrerEra": 4.57,
                "CurrentEra": 3.03,
                "SpecificEra": 2.857142857142857,
                "PitcherWins": 3,
                "PitcherLoses": 4,
                "FinalEra": 3.03,
                "AVG": 0.2517091516745362,
                "OPS": 0.6315921791883331,
                "OBP": 0.26857142857142857,
                "SLG": 0.5,
                "CoversPer": 22
            },
            "homeRow": {
                "team": "KCRoyals",
                "RelevingRuns": 1.2926829268292683,
                "formulaWinPercentage": 31.1651596761791,
                "SeriesPercentage": 26.172161172161168,
                "NextWinningPercentage": 60,
                "CurrentStreak": "W1-0",
                "TotalPercentage": 42.549430361975375,
                "Pitcher": "M Wacha",
                "CarrerEra": 3.97,
                "CurrentEra": 4.07,
                "SpecificEra": 4.05,
                "PitcherWins": 3,
                "PitcherLoses": 2,
                "FinalEra": 4.0200000000000005,
                "AVG": 0.24006258717569684,
                "OPS": 0.5269811996946142,
                "OBP": 0.2511818181818182,
                "SLG": 0.5,
                "CoversPer": 78
            },
            "selected": {}
        }
    }
];

        function calculateMostRepeatedValue(game) {
            const keys = ['formulaWinner', 'seriesWinner', 'nextWinners', 'overallWinner', 'isF5HomeWinner', 'isHomeWinner'];
            const counts = {};

            keys.forEach(key => {
                const value = game.common[key];
                if (!counts[value]) counts[value] = 0;
                counts[value]++;
            });

            let maxCount = 0;
            let mostRepeatedValue = null;
            Object.entries(counts).forEach(([value, count]) => {
                if (count > maxCount) {
                    mostRepeatedValue = value;
                    maxCount = count;
                }
            });

            return mostRepeatedValue;
        }

        function createCommonTable(game, container) {
            const mostRepeatedValue = calculateMostRepeatedValue(game);
            const table = document.createElement('table');
            table.className = 'table table-bordered';
            const thead = document.createElement('thead');
            const tbody = document.createElement('tbody');
            const headerRow = document.createElement('tr');
            const valueRow = document.createElement('tr');

            Object.keys(game.common).forEach(key => {
                const th = document.createElement('th');
                th.textContent = key;
                headerRow.appendChild(th);

                const td = document.createElement('td');
                td.textContent = isNaN(game.common[key]) ? game.common[key] : parseFloat(game.common[key]).toFixed(2);
                if (game.common[key] === mostRepeatedValue) {
                    td.classList.add('highlight');
                }
                valueRow.appendChild(td);
            });

            thead.appendChild(headerRow);
            tbody.appendChild(valueRow);
            table.appendChild(thead);
            table.appendChild(tbody);
            container.appendChild(table);
        }

        function createCompareTable(game, container) {
        const selectedTeam = game.compare.selected.team; // Getting the selected team value

        const table = document.createElement('table');
        table.className = 'table table-bordered';
        const thead = document.createElement('thead');
        const tbody = document.createElement('tbody');
        const headerRow = document.createElement('tr');
        const awayRow = document.createElement('tr');
        const homeRow = document.createElement('tr');

        Object.keys(game.compare.awayRow).forEach(key => {
            const th = document.createElement('th');
            th.textContent = key;
            headerRow.appendChild(th);

            const tdAway = document.createElement('td');
            const tdHome = document.createElement('td');

            // Populate the cells with values
            tdAway.textContent = isNaN(game.compare.awayRow[key]) ? game.compare.awayRow[key] : parseFloat(game.compare.awayRow[key]).toFixed(2);
            tdHome.textContent = isNaN(game.compare.homeRow[key]) ? game.compare.homeRow[key] : parseFloat(game.compare.homeRow[key]).toFixed(2);

            // Check for highlighting based on numeric value comparisons
            if (!isNaN(parseFloat(tdAway.textContent)) && !isNaN(parseFloat(tdHome.textContent))) {
                const awayValue = parseFloat(tdAway.textContent);
                const homeValue = parseFloat(tdHome.textContent);
                if (key.toLowerCase().includes('era') || (key == 'PitcherLoses') || key == "RelevingRuns")  {
                    if (awayValue < homeValue) tdAway.classList.add('highlight-lowest');
                    else if (homeValue < awayValue) tdHome.classList.add('highlight-lowest');
                } else {
                    if (awayValue > homeValue) tdAway.classList.add('highlight');
                    else if (homeValue > awayValue) tdHome.classList.add('highlight');
                }
            }

            // Highlight the team name if it matches the selected team
            if (key === 'team') {
                if (game.compare.awayRow.team === selectedTeam) tdAway.classList.add('highlight');
                if (game.compare.homeRow.team === selectedTeam) tdHome.classList.add('highlight');
            }

            // Highlight zero values in yellow for specified fields
            if (['SpecificEra', 'PitcherWins', 'PitcherLoses'].includes(key)) {
                if (parseFloat(tdAway.textContent) === 0) tdAway.style.backgroundColor = 'yellow';
                if (parseFloat(tdHome.textContent) === 0) tdHome.style.backgroundColor = 'yellow';
            }

            awayRow.appendChild(tdAway);
            homeRow.appendChild(tdHome);
        });

        thead.appendChild(headerRow);
        tbody.appendChild(awayRow);
        tbody.appendChild(homeRow);
        table.appendChild(thead);
        table.appendChild(tbody);
        container.appendChild(table);
    }

        document.addEventListener('DOMContentLoaded', () => {
            const mainContainer = document.querySelector('.custom-container');
            data.forEach(game => {
                const tableContainer = document.createElement('div');
                tableContainer.className = 'table-container';
                createCommonTable(game, tableContainer);
                createCompareTable(game, tableContainer);
                mainContainer.appendChild(tableContainer);
            });
        });
    </script>
</body>
</html>
